# Wazuh - Filebeat configuration file
filebeat.modules:
  - module: wazuh
    alerts:
      enabled: true
    archives:
      enabled: false

setup.template.json.enabled: true
setup.template.json.path: '/etc/filebeat/wazuh-template.json'
setup.template.json.name: 'wazuh'
setup.template.overwrite: true
setup.ilm.enabled: false

# Send events directly to Wazuh indexer
output.elasticsearch:
  hosts:
{% for item in wazuh_filebeat_output_indexer_hosts %}
  - {{ item }}
{% endfor %}

{% if wazuh_filebeat_security %}
  username: {{ wazuh_indexer_security_user }}
  password: "{{ wazuh_indexer_security_password }}"
  protocol: https
  ssl.certificate_authorities:
    - {{ wazuh_filebeat_ssl_dir }}/root-ca.pem
  ssl.certificate: "{{ wazuh_filebeat_ssl_dir }}/{{ wazuh_filebeat_node_name }}.pem"
  ssl.key: "{{ wazuh_filebeat_ssl_dir }}/{{ wazuh_filebeat_node_name }}-key.pem"
{% endif %}

# Optional. Send events to Logstash instead of Wazuh indexer
#output.logstash.hosts: ["YOUR_LOGSTASH_SERVER_IP:5000"]

logging.metrics.enabled: false

seccomp:
  default_action: allow
  syscalls:
  - action: allow
    names:
    - rseq
