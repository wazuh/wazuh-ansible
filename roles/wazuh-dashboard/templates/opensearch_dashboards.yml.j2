# Wazuh Dashboard Configuration
# Generated by Ansible

# Server settings
server.host: {{ wazuh_dashboard_host | default('0.0.0.0') }}
server.port: {{ wazuh_dashboard_port }}
server.name: "wazuh-dashboard"

# SSL/TLS settings
server.ssl.enabled: {{ wazuh_dashboard_ssl_enabled | lower }}
server.ssl.certificate: {{ wazuh_dashboard_certs_path }}/dashboard.pem
server.ssl.key: {{ wazuh_dashboard_certs_path }}/dashboard-key.pem

# Opensearch connection
opensearch.hosts:
{% for node in wazuh_indexer_nodes %}
  - https://{{ node.ip }}:{{ wazuh_indexer_http_port }}
{% endfor %}

opensearch.ssl.verificationMode: certificate
opensearch.username: {{ wazuh_indexer_admin_user }}
opensearch.password: {{ wazuh_indexer_admin_password }}
opensearch.ssl.certificateAuthorities:
  - {{ wazuh_dashboard_certs_path }}/root-ca.pem
opensearch.requestHeadersWhitelist:
  - securitytenant
  - Authorization

# Security settings
opensearch_security.multitenancy.enabled: false
opensearch_security.readonly_mode.roles:
  - kibana_read_only

# UI settings
uiSettings.overrides.defaultRoute: /app/wazuh

# Logging
logging.dest: /var/log/wazuh-dashboard/opensearch-dashboards.log

# Session timeout (in milliseconds)
opensearch_security.session.ttl: {{ (wazuh_dashboard_session_timeout | default(60)) * 60000 }}
opensearch_security.cookie.ttl: {{ (wazuh_dashboard_session_timeout | default(60)) * 60000 }}
